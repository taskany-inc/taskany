generator client {
  provider = "prisma-client-js"
}

generator typegraphql {
  provider = "typegraphql-prisma"
  output   = "../src/@generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("TASKANY_DATABASE_URL")
}

model Account {
  id                Int      @id @default(autoincrement())
  user              User     @relation(fields: [id], references: [id])
  providerType      String   @map(name: "provider_type")
  providerId        String   @map(name: "provider_id")
  providerAccountId Int      @map(name: "provider_account_id")
  createdAt         DateTime @default(now()) @map(name: "created_at")
  updatedAt         DateTime @default(now()) @map(name: "updated_at")


  @@index([providerAccountId], name: "providerAccountId")
  @@index([providerId], name: "providerId")
  @@map(name: "accounts")
}

model User {
  id            Int       @id @default(autoincrement())
  name          String?
  email         String?   @unique
  emailVerified DateTime? @map(name: "email_verified")
  image         String?
  accounts      Account[]
  createdQueues Queue[]   @relation("createdQueues")
  ownedQueues   Queue[]   @relation("ownedQueues")
  issues        Issue[]   @relation("createdBy")
  createdAt     DateTime  @default(now()) @map(name: "created_at")
  updatedAt     DateTime  @default(now()) @map(name: "updated_at")

  @@map(name: "users")
}

model Queue {
  id          Int      @id @default(autoincrement())
  key         String   @unique
  title       String?
  description String?
  createdBy   User     @relation("createdQueues", fields: [creatorId], references: [id])
  creatorId   Int
  owner       User     @relation("ownedQueues", fields: [ownerId], references: [id])
  ownerId     Int
  issues      Issue[]  @relation("queue")
  createdAt   DateTime @default(now()) @map(name: "created_at")
  updatedAt   DateTime @default(now()) @map(name: "updated_at")

  @@map(name: "queues")
}

model Issue {
  id          Int      @id @default(autoincrement())
  key         String   @unique
  title       String
  description String?
  createdBy   User     @relation("createdBy", fields: [creatorId], references: [id])
  creatorId   Int
  queue       Queue    @relation("queue", fields: [queueId], references: [id])
  queueId     Int
  createdAt   DateTime @default(now()) @map(name: "created_at")
  updatedAt   DateTime @default(now()) @map(name: "updated_at")
  //   kind      IssueKind @relation(name: "kind", fields: [id], references: [id])

  @@map(name: "issues")
}

// model IssueKind {
//   id        Int      @id @default(autoincrement())
//   kind      String   @unique
//   issues    Issue[]  @relation(name: "kind")
//   fields    Field[]  @relation(name: "fields")
//   createdAt DateTime @default(now()) @map(name: "created_at")
//   updatedAt DateTime @default(now()) @map(name: "updated_at")

//   @@map(name: "issueKinds")
// }

// model Field {
//   id         Int         @id @default(autoincrement())
//   name       String      @unique
//   issueKinds IssueKind[] @relation(name: "fields")
//   createdAt  DateTime    @default(now()) @map(name: "created_at")
//   updatedAt  DateTime    @default(now()) @map(name: "updated_at")

//   @@map(name: "fields")
// }
